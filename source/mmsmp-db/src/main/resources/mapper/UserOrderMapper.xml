<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zbensoft.mmsmp.db.mapper.UserOrderMapper">
  <resultMap id="BaseResultMap" type="com.zbensoft.mmsmp.db.domain.UserOrder">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    <id column="user_order_id" jdbcType="VARCHAR" property="userOrderId" />
    <result column="phone_number" jdbcType="VARCHAR" property="phoneNumber" />
    <result column="sp_info_id" jdbcType="VARCHAR" property="spInfoId" />
    <result column="product_info_id" jdbcType="VARCHAR" property="productInfoId" />
    <result column="charge_phone_number" jdbcType="VARCHAR" property="chargePhoneNumber" />
    <result column="order_time" jdbcType="TIMESTAMP" property="orderTime" />
    <result column="order_route" jdbcType="INTEGER" property="orderRoute" />
    <result column="order_type" jdbcType="INTEGER" property="orderType" />
    <result column="fee" jdbcType="DOUBLE" property="fee" />
    <result column="feature_str" jdbcType="VARCHAR" property="featureStr" />
    <result column="status" jdbcType="INTEGER" property="status" />
    <result column="version" jdbcType="VARCHAR" property="version" />
    <result column="not_disturb_time" jdbcType="VARCHAR" property="notDisturbTime" />
    <result column="transaction_id" jdbcType="VARCHAR" property="transactionId" />
    <result column="eff_time" jdbcType="TIMESTAMP" property="effTime" />
    <result column="area" jdbcType="VARCHAR" property="area" />
    <result column="priority" jdbcType="INTEGER" property="priority" />
    <result column="last_batch_id" jdbcType="VARCHAR" property="lastBatchId" />
    <result column="is_package" jdbcType="INTEGER" property="isPackage" />
    <result column="notify_sp_flag" jdbcType="INTEGER" property="notifySpFlag" />
  </resultMap>
  <resultMap id="selectMap" type="com.zbensoft.mmsmp.db.domain.UserStatistics">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    <result column="sp_info_id" jdbcType="VARCHAR" property="spInfoId" />
    <result column="order_count" jdbcType="NUMERIC" property="orderCount" />
    <result column="ondemand_count" jdbcType="NUMERIC" property="onDemandCount" />
    <result column="order_fee" jdbcType="DOUBLE" property="orderFee" />
     <result column="ondemand_fee" jdbcType="DOUBLE" property="onDemandFee" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
     user_order_id, phone_number, sp_info_id, product_info_id, charge_phone_number, order_time, order_route, 
    order_type, fee, feature_str, status, version, not_disturb_time, transaction_id, 
    eff_time, area, priority, last_batch_id, is_package, notify_sp_flag
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from user_order
    where user_order_id = #{userOrderId,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    delete from user_order
    where user_order_id = #{userOrderId,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    insert into user_order (user_order_id ,phone_number, sp_info_id, product_info_id, 
      charge_phone_number, order_time, order_route, 
      order_type, fee, feature_str, 
      status, version, not_disturb_time, 
      transaction_id, eff_time, area, 
      priority, last_batch_id, is_package, notify_sp_flag
      )
    values (#{userOrderId,jdbcType=VARCHAR}, #{phoneNumber,jdbcType=VARCHAR}, #{spInfoId,jdbcType=VARCHAR}, #{productInfoId,jdbcType=VARCHAR}, 
      #{chargePhoneNumber,jdbcType=VARCHAR}, #{orderTime,jdbcType=TIMESTAMP}, #{orderRoute,jdbcType=INTEGER}, 
      #{orderType,jdbcType=INTEGER}, #{fee,jdbcType=DOUBLE}, #{featureStr,jdbcType=VARCHAR}, 
      #{status,jdbcType=INTEGER}, #{version,jdbcType=VARCHAR}, #{notDisturbTime,jdbcType=VARCHAR}, 
      #{transactionId,jdbcType=VARCHAR}, #{effTime,jdbcType=TIMESTAMP}, #{area,jdbcType=VARCHAR}, 
      #{priority,jdbcType=INTEGER}, #{lastBatchId,jdbcType=VARCHAR}, #{isPackage,jdbcType=INTEGER}, #{notifySpFlag,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    insert into user_order
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="userOrderId != null">
        user_order_id,
      </if>
      <if test="phoneNumber != null">
        phone_number,
      </if>
      <if test="spInfoId != null">
        sp_info_id,
      </if>
      <if test="productInfoId != null">
        product_info_id,
      </if>
      <if test="chargePhoneNumber != null">
        charge_phone_number,
      </if>
      <if test="orderTime != null">
        order_time,
      </if>
      <if test="orderRoute != null">
        order_route,
      </if>
      <if test="orderType != null">
        order_type,
      </if>
      <if test="fee != null">
        fee,
      </if>
      <if test="featureStr != null">
        feature_str,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="version != null">
        version,
      </if>
      <if test="notDisturbTime != null">
        not_disturb_time,
      </if>
      <if test="transactionId != null">
        transaction_id,
      </if>
      <if test="effTime != null">
        eff_time,
      </if>
      <if test="area != null">
        area,
      </if>
      <if test="priority != null">
        priority,
      </if>
      <if test="lastBatchId != null">
        last_batch_id,
      </if>
      <if test="isPackage != null">
        is_package,
      </if>
      <if test="notifySpFlag != null">
        notify_sp_flag,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="userOrderId != null">
        #{userOrderId,jdbcType=VARCHAR},
      </if>
      <if test="phoneNumber != null">
        #{phoneNumber,jdbcType=VARCHAR},
      </if>
      <if test="spInfoId != null">
        #{spInfoId,jdbcType=VARCHAR},
      </if>
      <if test="productInfoId != null">
        #{productInfoId,jdbcType=VARCHAR},
      </if>
      <if test="chargePhoneNumber != null">
        #{chargePhoneNumber,jdbcType=VARCHAR},
      </if>
      <if test="orderTime != null">
        #{orderTime,jdbcType=TIMESTAMP},
      </if>
      <if test="orderRoute != null">
        #{orderRoute,jdbcType=INTEGER},
      </if>
      <if test="orderType != null">
        #{orderType,jdbcType=INTEGER},
      </if>
      <if test="fee != null">
        #{fee,jdbcType=DOUBLE},
      </if>
      <if test="featureStr != null">
        #{featureStr,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        #{status,jdbcType=INTEGER},
      </if>
      <if test="version != null">
        #{version,jdbcType=VARCHAR},
      </if>
      <if test="notDisturbTime != null">
        #{notDisturbTime,jdbcType=VARCHAR},
      </if>
      <if test="transactionId != null">
        #{transactionId,jdbcType=VARCHAR},
      </if>
      <if test="effTime != null">
        #{effTime,jdbcType=TIMESTAMP},
      </if>
      <if test="area != null">
        #{area,jdbcType=VARCHAR},
      </if>
      <if test="priority != null">
        #{priority,jdbcType=INTEGER},
      </if>
      <if test="lastBatchId != null">
        #{lastBatchId,jdbcType=VARCHAR},
      </if>
      <if test="isPackage != null">
        #{isPackage,jdbcType=INTEGER},
      </if>
       <if test="notifySpFlag != null">
        #{notifySpFlag,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    update user_order
    <set>
      <if test="phoneNumber != null">
        phone_number = #{phoneNumber,jdbcType=VARCHAR},
      </if>
      <if test="spInfoId != null">
        sp_info_id = #{spInfoId,jdbcType=VARCHAR},
      </if>
      <if test="productInfoId != null">
        product_info_id = #{productInfoId,jdbcType=VARCHAR},
      </if>
      <if test="chargePhoneNumber != null">
        charge_phone_number = #{chargePhoneNumber,jdbcType=VARCHAR},
      </if>
      <if test="orderTime != null">
        order_time = #{orderTime,jdbcType=TIMESTAMP},
      </if>
      <if test="orderRoute != null">
        order_route = #{orderRoute,jdbcType=INTEGER},
      </if>
      <if test="orderType != null">
        order_type = #{orderType,jdbcType=INTEGER},
      </if>
      <if test="fee != null">
        fee = #{fee,jdbcType=DOUBLE},
      </if>
      <if test="featureStr != null">
        feature_str = #{featureStr,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="version != null">
        version = #{version,jdbcType=VARCHAR},
      </if>
      <if test="notDisturbTime != null">
        not_disturb_time = #{notDisturbTime,jdbcType=VARCHAR},
      </if>
      <if test="transactionId != null">
        transaction_id = #{transactionId,jdbcType=VARCHAR},
      </if>
      <if test="effTime != null">
        eff_time = #{effTime,jdbcType=TIMESTAMP},
      </if>
      <if test="area != null">
        area = #{area,jdbcType=VARCHAR},
      </if>
      <if test="priority != null">
        priority = #{priority,jdbcType=INTEGER},
      </if>
      <if test="lastBatchId != null">
        last_batch_id = #{lastBatchId,jdbcType=VARCHAR},
      </if>
      <if test="isPackage != null">
        is_package = #{isPackage,jdbcType=INTEGER},
      </if>
       <if test="notifySpFlag != null">
        notify_sp_flag = #{notifySpFlag,jdbcType=INTEGER},
      </if>
    </set>
    where user_order_id = #{userOrderId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    update user_order
    set phone_number = #{phoneNumber,jdbcType=VARCHAR},
      sp_info_id = #{spInfoId,jdbcType=VARCHAR},
      product_info_id = #{productInfoId,jdbcType=VARCHAR},
      charge_phone_number = #{chargePhoneNumber,jdbcType=VARCHAR},
      order_time = #{orderTime,jdbcType=TIMESTAMP},
      order_route = #{orderRoute,jdbcType=INTEGER},
      order_type = #{orderType,jdbcType=INTEGER},
      fee = #{fee,jdbcType=DOUBLE},
      feature_str = #{featureStr,jdbcType=VARCHAR},
      status = #{status,jdbcType=INTEGER},
      version = #{version,jdbcType=VARCHAR},
      not_disturb_time = #{notDisturbTime,jdbcType=VARCHAR},
      transaction_id = #{transactionId,jdbcType=VARCHAR},
      eff_time = #{effTime,jdbcType=TIMESTAMP},
      area = #{area,jdbcType=VARCHAR},
      priority = #{priority,jdbcType=INTEGER},
      last_batch_id = #{lastBatchId,jdbcType=VARCHAR},
      is_package = #{isPackage,jdbcType=INTEGER},
      notify_sp_flag = #{notifySpFlag,jdbcType=INTEGER}
    where user_order_id = #{userOrderId,jdbcType=VARCHAR}
  </update>
   <select id="selectPage" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from user_order where 1=1
     <if test=" null != userOrderId and '' != userOrderId and 'undefined'!= userOrderId">
        and user_order_id = #{userOrderId,jdbcType=VARCHAR}
     </if>
     <if test=" null != phoneNumber and '' != phoneNumber and 'undefined'!= phoneNumber">
        and phone_number = #{phoneNumber,jdbcType=VARCHAR}
     </if>
      <if test=" null != spInfoId and '' != spInfoId and 'undefined'!= spInfoId ">
        and sp_info_id = #{spInfoId,jdbcType=VARCHAR}
     </if>
      <if test=" null != productInfoId and '' != productInfoId and 'undefined'!= productInfoId ">
        and product_info_id = #{productInfoId,jdbcType=VARCHAR}
     </if>
      <if test=" null != chargePhoneNumber and '' != chargePhoneNumber and 'undefined'!= chargePhoneNumber ">
        and charge_phone_number = #{chargePhoneNumber,jdbcType=VARCHAR}
     </if>
      <if test=" null != orderTime and '' != orderTime and 'undefined'!= orderTime">
        and order_time = #{orderTime,jdbcType=TIMESTAMP}
     </if>
      <if test=" null != orderRoute ">
        and order_route = #{orderRoute,jdbcType=INTEGER}
     </if>
      <if test=" null != orderType ">
        and order_type = #{orderType,jdbcType=INTEGER}
     </if>
      <if test=" null != fee ">
        and fee = #{fee,jdbcType=DOUBLE}
     </if>
     <if test=" null != featureStr and '' != featureStr and 'undefined'!= featureStr">
        and feature_str = #{featureStr,jdbcType=VARCHAR}
     </if>
     <if test=" null != status ">
        and status = #{status,jdbcType=INTEGER}
     </if>
     <if test=" null != version and '' != version and 'undefined'!= version">
        and version = #{version,jdbcType=VARCHAR}
     </if>
     <if test=" null != notDisturbTime and '' != notDisturbTime and 'undefined'!= notDisturbTime">
        and not_disturb_time = #{notDisturbTime,jdbcType=VARCHAR}
     </if>
      <if test=" null != transactionId and '' != transactionId and 'undefined'!= transactionId">
        and transaction_id = #{transactionId,jdbcType=TIMESTAMP}
     </if>
      <if test=" null != effTime and '' != effTime and 'undefined'!= effTime">
        and eff_time = #{effTime,jdbcType=TIMESTAMP}
     </if>
     <if test=" null != area and '' != area and 'undefined'!= area">
        and area = #{area,jdbcType=VARCHAR}
     </if>
     <if test=" null != priority and '' != priority and 'undefined'!= priority">
        and priority = #{priority,jdbcType=VARCHAR}
     </if>
     <if test=" null != lastBatchId and '' != lastBatchId and 'undefined'!= lastBatchId">
        and last_batch_id = #{lastBatchId,jdbcType=VARCHAR}
     </if>
      <if test=" null != isPackage ">
        and is_package = #{isPackage,jdbcType=INTEGER}
     </if>
     <if test=" null != notifySpFlag ">
        and notify_sp_flag = #{notifySpFlag,jdbcType=INTEGER}
     </if>
     order by priority desc
  </select>
    <select id="count" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder" resultType="int">
    select 
    count(1)
    from user_order where 1=1
     <if test=" null != userOrderId and '' != userOrderId and 'undefined'!= userOrderId">
        and user_order_id = #{userOrderId,jdbcType=VARCHAR}
     </if>
      <if test=" null != phoneNumber and '' != phoneNumber and 'undefined'!= phoneNumber">
        and phone_number = #{phoneNumber,jdbcType=VARCHAR}
     </if>
      <if test=" null != spInfoId and '' != spInfoId and 'undefined'!= spInfoId ">
        and sp_info_id = #{spInfoId,jdbcType=VARCHAR}
     </if>
      <if test=" null != productInfoId and '' != productInfoId and 'undefined'!= productInfoId ">
        and product_info_id = #{productInfoId,jdbcType=VARCHAR}
     </if>
      <if test=" null != chargePhoneNumber and '' != chargePhoneNumber and 'undefined'!= chargePhoneNumber ">
        and charge_phone_number = #{chargePhoneNumber,jdbcType=VARCHAR}
     </if>
      <if test=" null != orderTime and '' != orderTime and 'undefined'!= orderTime">
        and order_time = #{orderTime,jdbcType=TIMESTAMP}
     </if>
      <if test=" null != orderRoute ">
        and order_route = #{orderRoute,jdbcType=INTEGER}
     </if>
      <if test=" null != orderType ">
        and order_type = #{orderType,jdbcType=INTEGER}
     </if>
      <if test=" null != fee ">
        and fee = #{fee,jdbcType=DOUBLE}
     </if>
     <if test=" null != featureStr and '' != featureStr and 'undefined'!= featureStr">
        and feature_str = #{featureStr,jdbcType=VARCHAR}
     </if>
     <if test=" null != status ">
        and status = #{status,jdbcType=INTEGER}
     </if>
     <if test=" null != version and '' != version and 'undefined'!= version">
        and version = #{version,jdbcType=VARCHAR}
     </if>
     <if test=" null != notDisturbTime and '' != notDisturbTime and 'undefined'!= notDisturbTime">
        and not_disturb_time = #{notDisturbTime,jdbcType=VARCHAR}
     </if>
      <if test=" null != transactionId and '' != transactionId and 'undefined'!= transactionId">
        and transaction_id = #{transactionId,jdbcType=TIMESTAMP}
     </if>
      <if test=" null != effTime and '' != effTime and 'undefined'!= effTime">
        and eff_time = #{effTime,jdbcType=TIMESTAMP}
     </if>
     <if test=" null != area and '' != area and 'undefined'!= area">
        and area = #{area,jdbcType=VARCHAR}
     </if>
     <if test=" null != priority and '' != priority and 'undefined'!= priority">
        and priority = #{priority,jdbcType=VARCHAR}
     </if>
     <if test=" null != lastBatchId and '' != lastBatchId and 'undefined'!= lastBatchId">
        and last_batch_id = #{lastBatchId,jdbcType=VARCHAR}
     </if>
      <if test=" null != isPackage ">
        and is_package = #{isPackage,jdbcType=INTEGER}
     </if>
     <if test=" null != notifySpFlag ">
        and notify_sp_flag = #{notifySpFlag,jdbcType=INTEGER}
     </if>
     order by priority desc
  </select>
  <delete id="delUserOrder" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    delete from user_order
    where (phone_number = #{phoneNumber,jdbcType=VARCHAR} and product_info_id = #{productInfoId,jdbcType=VARCHAR})
  </delete>
   <select id="selectOrderRelationBySpProductId" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder" resultType="java.lang.Integer">
	   select count(1) from user_order u,product_service p where p.product_info_id = u.product_info_id

       <if test=" null != spProductId and '' != spProductId and 'undefined'!= spProductId">
           and p.sp_product_id = #{spProductId,jdbcType=VARCHAR}
       </if>

       <if test=" null != phoneNumber and '' != phoneNumber and 'undefined'!= phoneNumber">
           and u.phone_number = #{phoneNumber,jdbcType=VARCHAR}
       </if>
   </select>
   <select id="selectOrderRelation" parameterType="com.zbensoft.mmsmp.db.domain.UserOrder" resultMap="BaseResultMap">
	   select u.user_order_id, u.phone_number, u.sp_info_id, u.product_info_id, u.charge_phone_number, u.order_time, u.order_route, 
    u.order_type, u.fee, u.feature_str, u.status, u.version, u.not_disturb_time, u.transaction_id, 
    u.eff_time, u.area, u.priority, u.last_batch_id, u.is_package, u.notify_sp_flag from user_order u,product_service p where p.product_info_id = u.product_info_id

       <if test=" null != spProductId and '' != spProductId and 'undefined'!= spProductId">
           and p.sp_product_id = #{spProductId,jdbcType=VARCHAR}
       </if>

       <if test=" null != phoneNumber and '' != phoneNumber and 'undefined'!= phoneNumber">
           and u.phone_number = #{phoneNumber,jdbcType=VARCHAR}
       </if>
   </select>
  <select id="selectByPhoneNumber" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from user_order
    where phone_number = #{phoneNumber,jdbcType=VARCHAR}
  </select>
  <select id="selectCountByOrderAndSpInfoId" parameterType="com.zbensoft.mmsmp.db.domain.UserStatistics" resultMap="selectMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    select 
    count(*) as order_count,uo.sp_info_id
    from user_order uo
    where 1=1 
    <if test=" null != spInfoId and '' != spInfoId and 'undefined'!= spInfoId ">
        and uo.sp_info_id = #{spInfoId,jdbcType=VARCHAR}
    </if>
    <if test="monthStart != null and monthStart !=''">
        <![CDATA[   and DATE_FORMAT(uo.order_time, '%Y-%m-%d %H:%i:%S')>=  DATE_FORMAT(#{monthStart}, '%Y-%m-%d %H:%i:%S')   ]]>  
      </if>
      <if test="monthEnd != null and monthEnd !=''">
       <![CDATA[   and DATE_FORMAT(uo.order_time, '%Y-%m-%d %H:%i:%S')<=  DATE_FORMAT(#{monthEnd}, '%Y-%m-%d %H:%i:%S')   ]]>  
      </if>
      and uo.order_type = 1
      group by uo.sp_info_id
  </select>
   <select id="selectCountByOnDemandAndSpInfoId" parameterType="com.zbensoft.mmsmp.db.domain.UserStatistics" resultMap="selectMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 27 14:33:49 CST 2018.
    -->
    select 
    count(*) as ondemand_count,uo.sp_info_id
    from user_order uo
     where 1=1 
    <if test=" null != spInfoId and '' != spInfoId and 'undefined'!= spInfoId ">
        and uo.sp_info_id = #{spInfoId,jdbcType=VARCHAR}
    </if>
     <if test="monthStart != null and monthStart !=''">
        <![CDATA[   and DATE_FORMAT(uo.order_time, '%Y-%m-%d %H:%i:%S')>=  DATE_FORMAT(#{monthStart}, '%Y-%m-%d %H:%i:%S')   ]]>  
      </if>
      <if test="monthEnd != null and monthEnd !=''">
       <![CDATA[   and DATE_FORMAT(uo.order_time, '%Y-%m-%d %H:%i:%S')<=  DATE_FORMAT(#{monthEnd}, '%Y-%m-%d %H:%i:%S')   ]]>  
      </if>
      and uo.order_type = 2
      group by uo.sp_info_id
  </select>
  <delete id="deleteByPhoneNumber" parameterType="java.lang.String">
    delete from user_order
    where phone_number = #{phoneNumber,jdbcType=VARCHAR}
  </delete>
  
  <select id="getSpProductIds" parameterType="java.lang.String" resultMap="BaseResultMap">
    SELECT
		product_service.sp_product_id as spProductId
	FROM
		user_order,
		product_service
	WHERE
		user_order.product_info_id = product_service.product_info_id
	AND user_order.phone_number = #{phoneNumber,jdbcType=VARCHAR}
  </select>
</mapper>