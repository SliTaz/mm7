<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zbensoft.mmsmp.db.mapper.SysMenuMapper">
  <resultMap id="BaseResultMap" type="com.zbensoft.mmsmp.db.domain.SysMenu">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jun 08 10:36:56 CST 2017.
    -->
    <id column="menu_id" jdbcType="VARCHAR" property="menuId" />
    <result column="menu_key_word" jdbcType="VARCHAR" property="menuKeyWord" />
    <result column="menu_sortno" jdbcType="INTEGER" property="menuSortno" />
    <result column="menu_name_cn" jdbcType="VARCHAR" property="menuNameCn" />
    <result column="menu_name_en" jdbcType="VARCHAR" property="menuNameEn" />
    <result column="menu_name_es" jdbcType="VARCHAR" property="menuNameEs" />
    <result column="menu_pic" jdbcType="VARCHAR" property="menuPic" />
    <result column="menu_type" jdbcType="VARCHAR" property="menuType" />
    <result column="pre_menu_id" jdbcType="VARCHAR" property="preMenuId" />
    <result column="menu_proces" jdbcType="VARCHAR" property="menuProces" />
    <result column="remark" jdbcType="VARCHAR" property="remark" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jun 08 10:36:56 CST 2017.
    -->
    menu_id, menu_key_word, menu_sortno, menu_name_cn, menu_name_en, menu_name_es, menu_pic, 
    menu_type, pre_menu_id, menu_proces, remark
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jun 08 10:36:56 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from sys_menu
    where menu_id = #{menuId,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jun 08 10:36:56 CST 2017.
    -->
    delete from sys_menu
    where menu_id = #{menuId,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.zbensoft.mmsmp.db.domain.SysMenu">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jun 08 10:36:56 CST 2017.
    -->
    insert into sys_menu (menu_id, menu_key_word, menu_sortno, 
      menu_name_cn, menu_name_en, menu_name_es, 
      menu_pic, menu_type, pre_menu_id, 
      menu_proces, remark)
    values (#{menuId,jdbcType=VARCHAR}, #{menuKeyWord,jdbcType=VARCHAR}, #{menuSortno,jdbcType=INTEGER}, 
      #{menuNameCn,jdbcType=VARCHAR}, #{menuNameEn,jdbcType=VARCHAR}, #{menuNameEs,jdbcType=VARCHAR}, 
      #{menuPic,jdbcType=VARCHAR}, #{menuType,jdbcType=VARCHAR}, #{preMenuId,jdbcType=VARCHAR}, 
      #{menuProces,jdbcType=VARCHAR}, #{remark,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.zbensoft.mmsmp.db.domain.SysMenu">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jun 08 10:36:56 CST 2017.
    -->
    insert into sys_menu
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="menuId != null">
        menu_id,
      </if>
      <if test="menuKeyWord != null">
        menu_key_word,
      </if>
      <if test="menuSortno != null">
        menu_sortno,
      </if>
      <if test="menuNameCn != null">
        menu_name_cn,
      </if>
      <if test="menuNameEn != null">
        menu_name_en,
      </if>
      <if test="menuNameEs != null">
        menu_name_es,
      </if>
      <if test="menuPic != null">
        menu_pic,
      </if>
      <if test="menuType != null">
        menu_type,
      </if>
      <if test="preMenuId != null">
        pre_menu_id,
      </if>
      <if test="menuProces != null">
        menu_proces,
      </if>
      <if test="remark != null">
        remark,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="menuId != null">
        #{menuId,jdbcType=VARCHAR},
      </if>
      <if test="menuKeyWord != null">
        #{menuKeyWord,jdbcType=VARCHAR},
      </if>
      <if test="menuSortno != null">
        #{menuSortno,jdbcType=INTEGER},
      </if>
      <if test="menuNameCn != null">
        #{menuNameCn,jdbcType=VARCHAR},
      </if>
      <if test="menuNameEn != null">
        #{menuNameEn,jdbcType=VARCHAR},
      </if>
      <if test="menuNameEs != null">
        #{menuNameEs,jdbcType=VARCHAR},
      </if>
      <if test="menuPic != null">
        #{menuPic,jdbcType=VARCHAR},
      </if>
      <if test="menuType != null">
        #{menuType,jdbcType=VARCHAR},
      </if>
      <if test="preMenuId != null">
        #{preMenuId,jdbcType=VARCHAR},
      </if>
      <if test="menuProces != null">
        #{menuProces,jdbcType=VARCHAR},
      </if>
      <if test="remark != null">
        #{remark,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.zbensoft.mmsmp.db.domain.SysMenu">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jun 08 10:36:56 CST 2017.
    -->
    update sys_menu
    <set>
      <if test="menuKeyWord != null">
        menu_key_word = #{menuKeyWord,jdbcType=VARCHAR},
      </if>
      <if test="menuSortno != null">
        menu_sortno = #{menuSortno,jdbcType=INTEGER},
      </if>
      <if test="menuNameCn != null">
        menu_name_cn = #{menuNameCn,jdbcType=VARCHAR},
      </if>
      <if test="menuNameEn != null">
        menu_name_en = #{menuNameEn,jdbcType=VARCHAR},
      </if>
      <if test="menuNameEs != null">
        menu_name_es = #{menuNameEs,jdbcType=VARCHAR},
      </if>
      <if test="menuPic != null">
        menu_pic = #{menuPic,jdbcType=VARCHAR},
      </if>
      <if test="menuType != null">
        menu_type = #{menuType,jdbcType=VARCHAR},
      </if>
      <if test="preMenuId != null">
        pre_menu_id = #{preMenuId,jdbcType=VARCHAR},
      </if>
      <if test="menuProces != null">
        menu_proces = #{menuProces,jdbcType=VARCHAR},
      </if>
      <if test="remark != null">
        remark = #{remark,jdbcType=VARCHAR},
      </if>
    </set>
    where menu_id = #{menuId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.zbensoft.mmsmp.db.domain.SysMenu">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jun 08 10:36:56 CST 2017.
    -->
    update sys_menu
    set menu_key_word = #{menuKeyWord,jdbcType=VARCHAR},
      menu_sortno = #{menuSortno,jdbcType=INTEGER},
      menu_name_cn = #{menuNameCn,jdbcType=VARCHAR},
      menu_name_en = #{menuNameEn,jdbcType=VARCHAR},
      menu_name_es = #{menuNameEs,jdbcType=VARCHAR},
      menu_pic = #{menuPic,jdbcType=VARCHAR},
      menu_type = #{menuType,jdbcType=VARCHAR},
      pre_menu_id = #{preMenuId,jdbcType=VARCHAR},
      menu_proces = #{menuProces,jdbcType=VARCHAR},
      remark = #{remark,jdbcType=VARCHAR}
    where menu_id = #{menuId,jdbcType=VARCHAR}
  </update>
 <select id="count" parameterType="com.zbensoft.mmsmp.db.domain.SysMenu" resultType="int">
     select 
    count(1)
    from sys_menu
  where 1=1
     <if test=" null != menuKeyWord and '' != menuKeyWord and 'undefined'!= menuKeyWord ">
        and menu_key_word = #{menuKeyWord,jdbcType=VARCHAR}
     </if>
     <if test=" null != menuSortno">
        and menu_sortno = #{menuSortno,jdbcType=INTEGER}
     </if>
    
     <if test=" null != menuNameCn and '' != menuNameCn and 'undefined'!= menuNameCn">
        and menu_name_cn = #{menuNameCn,jdbcType=VARCHAR}
     </if>
     <if test=" null != menuNameEn and '' != menuNameEn and 'undefined'!= menuNameEn">
        and menu_name_en = #{menuNameEn,jdbcType=VARCHAR}
     </if>
     <if test=" null != menuNameEs and '' != menuNameEs and 'undefined'!= menuNameEs">
        and menu_name_es = #{menuNameEs,jdbcType=VARCHAR}
     </if>
     <if test=" null != menuType and '' != menuType and 'undefined'!=menuType">
        and menu_type = #{menuType,jdbcType=VARCHAR}
     </if> 
     </select>
     
      <select id="selectPage" parameterType="com.zbensoft.mmsmp.db.domain.SysMenu" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed May 24 13:36:02 CST 2017.
    -->
   
       select 
    <include refid="Base_Column_List" />
    from sys_menu
        where 1=1
     <if test=" null != menuKeyWord and '' != menuKeyWord and 'undefined'!= menuKeyWord ">
        and menu_key_word = #{menuKeyWord,jdbcType=VARCHAR}
     </if>
     <if test=" null != menuSortno">
        and menu_sortno = #{menuSortno,jdbcType=INTEGER}
     </if>
    
     <if test=" null != menuNameCn and '' != menuNameCn and 'undefined'!= menuNameCn">
        and menu_name_cn = #{menuNameCn,jdbcType=VARCHAR}
     </if>
     <if test=" null != menuNameEn and '' != menuNameEn and 'undefined'!= menuNameEn">
        and menu_name_en = #{menuNameEn,jdbcType=VARCHAR}
     </if>
     <if test=" null != menuNameEs and '' != menuNameEs and 'undefined'!= menuNameEs">
        and menu_name_es = #{menuNameEs,jdbcType=VARCHAR}
     </if>
     <if test=" null != menuType and '' != menuType and 'undefined'!=menuType">
        and menu_type = #{menuType,jdbcType=VARCHAR}
     </if> 
  </select>
  <select id="getUserMenus" parameterType="com.zbensoft.mmsmp.db.domain.SysMenuUserMenuParam" resultMap="BaseResultMap">
		SELECT DISTINCT
				a.menu_id,
				a.menu_key_word,
				a.menu_sortno,
				a.menu_name_cn,
				a.menu_name_en,
				a.menu_name_es,
				a.menu_pic,
				a.menu_type,
				a.pre_menu_id,
				a.menu_proces,
				a.remark
		FROM
			sys_menu a,
			sys_role_user b,
			sys_role_menu c
		WHERE
			a.menu_id = c.menu_id
		AND b.role_id = c.role_id
		AND b.user_id = #{userId,jdbcType=VARCHAR}
		AND a.menu_type = #{menuType,jdbcType=INTEGER}
		order by a.menu_sortno
  </select>
   <select id="selectByMenuName" parameterType="java.lang.String" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from sys_menu
    where menu_name_cn = #{menuNameCn,jdbcType=VARCHAR}
  </select>
  
  <select id="getRoleResources" parameterType="java.lang.String" resultType="com.zbensoft.mmsmp.db.domain.SysMenu">
    select 
 		menu_id as menuId,
		menu_name_cn as menuNameCn,
		menu_name_en as menuNameEn,
		menu_name_es as menuNameEs,
		pre_menu_id as preMenuId,
		(select m.menu_name_cn from sys_menu m where m.menu_id=sys_menu.pre_menu_id) parentName,
		menu_key_word as menuKeyWord,
		menu_type as menuType,
		menu_proces as menuProces,
		menu_sortno as menuSortno,
		remark
 	from sys_menu where menu_id in (select menu_id from sys_role_menu where role_id=#{id})
  </select>
  
  <select id="findAll" resultType="com.zbensoft.mmsmp.db.domain.SysMenu">
    select
	  menu_id as menuId,
		menu_name_cn as menuNameCn,
		menu_name_en as menuNameEn,
		menu_name_es as menuNameEs,
		pre_menu_id as preMenuId,
		(select m.menu_name_cn from sys_menu m where m.menu_id=sys_menu.pre_menu_id) parentName,
		menu_key_word as menuKeyWord,
		menu_type as menuType,
		menu_proces as menuProces,
		menu_sortno as menuSortno,
		remark
 	from sys_menu order By menu_sortno asc
  </select>
  <delete id="deleteRoleRescours" parameterType="java.lang.String">
    delete from sys_role_menu where role_id = #{roleId}
  </delete>
  <insert id="saveRoleRescours" parameterType="com.zbensoft.mmsmp.db.domain.SysMenu">
    insert into sys_role_menu(role_id,menu_id) values (#{roleId},#{rescId})
  </insert>
  
     <select id="getMenuByMenuKeyWord" parameterType="java.lang.String" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from sys_menu
    where menu_key_word = #{menuKeyWord,jdbcType=VARCHAR}
  </select>
</mapper>